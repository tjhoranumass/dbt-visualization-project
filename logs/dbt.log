[0m09:56:15.868258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fdfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fd970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407c0b0>]}


============================== 09:56:15.871127 | 9ab9972b-4ade-4174-a125-6d40ab6280c7 ==============================
[0m09:56:15.871127 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:56:15.871486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:56:17.174347 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:56:17.174748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523f500>]}
[0m09:56:17.257424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2fe00>]}
[0m09:56:17.294557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cdbda0>]}
[0m09:56:17.295063 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:56:17.317085 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:56:17.317725 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:56:17.317964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523f560>]}
[0m09:56:18.018414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:56:18.024191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051418b0>]}
[0m09:56:18.074345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df3140>]}
[0m09:56:18.074647 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:56:18.074845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057efc80>]}
[0m09:56:18.075837 [info ] [MainThread]: 
[0m09:56:18.076140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:56:18.078550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:56:18.116730 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:56:18.116989 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:56:18.117159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:18.263774 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.146 seconds
[0m09:56:18.265566 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:56:18.267263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m09:56:18.267871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m09:56:18.273780 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:56:18.275431 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:56:18.275768 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:56:18.276064 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:56:18.276328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:18.276600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:18.377691 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m09:56:18.378287 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m09:56:18.378931 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:56:18.379416 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:56:18.379919 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:56:18.380487 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:56:18.404606 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m09:56:18.405271 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m09:56:18.408106 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:56:18.410372 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:56:18.421693 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:56:18.422252 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:56:18.431394 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.431951 [debug] [MainThread]: On master: BEGIN
[0m09:56:18.432423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:56:18.537799 [debug] [MainThread]: SQL status: BEGIN in 0.105 seconds
[0m09:56:18.538854 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.539622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:56:18.566751 [debug] [MainThread]: SQL status: SELECT 0 in 0.026 seconds
[0m09:56:18.571605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057794c0>]}
[0m09:56:18.572635 [debug] [MainThread]: On master: ROLLBACK
[0m09:56:18.581812 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.582671 [debug] [MainThread]: On master: BEGIN
[0m09:56:18.601926 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:56:18.603558 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.604494 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.605154 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.613824 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m09:56:18.614992 [debug] [MainThread]: On master: Close
[0m09:56:18.616353 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:56:18.617215 [info ] [MainThread]: 
[0m09:56:18.622629 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m09:56:18.623851 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m09:56:18.624609 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m09:56:18.625494 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m09:56:18.626564 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m09:56:18.627371 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m09:56:18.628182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m09:56:18.628892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m09:56:18.629614 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m09:56:18.630176 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:56:18.630713 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:56:18.631214 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m09:56:18.640294 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:56:18.643527 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:56:18.646281 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m09:56:18.647718 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m09:56:18.648165 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m09:56:18.648580 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:56:18.686685 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m09:56:18.687029 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:56:18.689008 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:56:18.689954 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:56:18.690250 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m09:56:18.690527 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:56:18.690805 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:56:18.691018 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:56:18.691256 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m09:56:18.691489 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m09:56:18.691782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:56:18.692000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:18.786450 [debug] [Thread-3 (]: SQL status: BEGIN in 0.095 seconds
[0m09:56:18.786856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m09:56:18.787244 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:56:18.787581 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:56:18.787923 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales;
  );
[0m09:56:18.788290 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers;
  );
[0m09:56:18.798906 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24: FROM raw_sales;
                       ^

[0m09:56:18.799277 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: FROM raw_customers;
                           ^

[0m09:56:18.799625 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: ROLLBACK
[0m09:56:18.799946 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: ROLLBACK
[0m09:56:18.803208 [debug] [Thread-2 (]: SQL status: BEGIN in 0.111 seconds
[0m09:56:18.803546 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:56:18.803885 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products;
  );
[0m09:56:18.810410 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m09:56:18.810870 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m09:56:18.815719 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: FROM raw_products;
                          ^

[0m09:56:18.816362 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: ROLLBACK
[0m09:56:18.819286 [debug] [Thread-3 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM raw_sales;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:56:18.820662 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM raw_customers;
                             ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:56:18.822055 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106447f80>]}
[0m09:56:18.822462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e5850>]}
[0m09:56:18.823026 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_sales .......................... [[31mERROR[0m in 0.19s]
[0m09:56:18.823524 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.19s]
[0m09:56:18.824006 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m09:56:18.824416 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:56:18.825488 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m09:56:18.825834 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m09:56:18.826155 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.orders_by_customer ................................. [[33mSKIP[0m]
[0m09:56:18.826540 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m09:56:18.826858 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.orders_by_day ...................................... [[33mSKIP[0m]
[0m09:56:18.827230 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m09:56:18.827608 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m09:56:18.827933 [info ] [Thread-1 (]: 6 of 6 SKIP relation public.product_performance ................................ [[33mSKIP[0m]
[0m09:56:18.828286 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m09:56:18.828721 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m09:56:18.830958 [debug] [Thread-2 (]: Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM raw_products;
                            ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:56:18.831307 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106368920>]}
[0m09:56:18.831788 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.20s]
[0m09:56:18.832239 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m09:56:18.833129 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.833398 [debug] [MainThread]: On master: BEGIN
[0m09:56:18.833617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:56:18.934442 [debug] [MainThread]: SQL status: BEGIN in 0.101 seconds
[0m09:56:18.935015 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.935410 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.935780 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.947744 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m09:56:18.948131 [debug] [MainThread]: On master: Close
[0m09:56:18.948731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:18.949090 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m09:56:18.949421 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_products' was properly closed.
[0m09:56:18.949740 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_sales' was properly closed.
[0m09:56:18.950197 [info ] [MainThread]: 
[0m09:56:18.950609 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m09:56:18.951802 [debug] [MainThread]: Command end result
[0m09:56:18.981802 [info ] [MainThread]: 
[0m09:56:18.982217 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:56:18.982483 [info ] [MainThread]: 
[0m09:56:18.982815 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM raw_sales;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:56:18.983075 [info ] [MainThread]: 
[0m09:56:18.983365 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM raw_customers;
                             ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:56:18.983607 [info ] [MainThread]: 
[0m09:56:18.983889 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM raw_products;
                            ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:56:18.984133 [info ] [MainThread]: 
[0m09:56:18.984390 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 TOTAL=6
[0m09:56:18.998358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1822715, "process_user_time": 2.035665, "process_kernel_time": 0.209253, "process_mem_max_rss": "140115968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:56:18.998864 [debug] [MainThread]: Command `dbt run` failed at 09:56:18.998792 after 3.18 seconds
[0m09:56:18.999192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104764b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105142000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbc890>]}
[0m09:56:18.999500 [debug] [MainThread]: Flushing usage events
[0m09:57:24.329741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb4110>]}


============================== 09:57:24.333104 | c322a947-d386-4167-a618-6ea445755716 ==============================
[0m09:57:24.333104 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:57:24.333462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:24.369099 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:57:24.369403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090475f0>]}
[0m09:57:24.431253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a0620>]}
[0m09:57:24.467473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c114f0>]}
[0m09:57:24.468006 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:57:24.477430 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:57:24.540520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:57:24.540898 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_sales.sql
[0m09:57:24.541115 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_customers.sql
[0m09:57:24.541329 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_products.sql
[0m09:57:24.681317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:57:24.687723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095be810>]}
[0m09:57:24.736615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109670230>]}
[0m09:57:24.736923 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:57:24.737118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c81af0>]}
[0m09:57:24.738170 [info ] [MainThread]: 
[0m09:57:24.738493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:24.740840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:57:24.768408 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:57:24.768663 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:57:24.768829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:24.916974 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.148 seconds
[0m09:57:24.919016 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:57:24.920737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m09:57:24.921291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m09:57:24.927832 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:57:24.929515 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:57:24.929868 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:57:24.930161 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:57:24.930444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:24.930705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:25.052158 [debug] [ThreadPool]: SQL status: BEGIN in 0.121 seconds
[0m09:57:25.053030 [debug] [ThreadPool]: SQL status: BEGIN in 0.122 seconds
[0m09:57:25.053801 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:57:25.054299 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:57:25.054820 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:57:25.055361 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:57:25.071451 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m09:57:25.072101 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m09:57:25.074562 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:57:25.076622 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:57:25.087943 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:57:25.088811 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:57:25.097065 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.097640 [debug] [MainThread]: On master: BEGIN
[0m09:57:25.098095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:25.225433 [debug] [MainThread]: SQL status: BEGIN in 0.127 seconds
[0m09:57:25.226717 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.227677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:57:25.246198 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m09:57:25.251025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b6930>]}
[0m09:57:25.252305 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:25.265375 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.266145 [debug] [MainThread]: On master: BEGIN
[0m09:57:25.289479 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m09:57:25.290909 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.291896 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.292956 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.305269 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m09:57:25.305823 [debug] [MainThread]: On master: Close
[0m09:57:25.306898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:57:25.307473 [info ] [MainThread]: 
[0m09:57:25.311675 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m09:57:25.312411 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m09:57:25.313226 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m09:57:25.313881 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m09:57:25.314644 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m09:57:25.315363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m09:57:25.316060 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m09:57:25.316676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m09:57:25.317507 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:57:25.318169 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m09:57:25.318684 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:57:25.329099 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:57:25.329762 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m09:57:25.334453 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:57:25.337267 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m09:57:25.337984 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:57:25.344286 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m09:57:25.363054 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m09:57:25.380554 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:57:25.380890 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:57:25.382657 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m09:57:25.383197 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:57:25.383499 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:57:25.383734 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m09:57:25.383951 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:57:25.384172 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m09:57:25.384385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:25.384586 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m09:57:25.384780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:57:25.385067 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:57:25.478618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.094 seconds
[0m09:57:25.479040 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:57:25.479362 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM customers;
  );
[0m09:57:25.487146 [debug] [Thread-2 (]: SQL status: BEGIN in 0.102 seconds
[0m09:57:25.487430 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:57:25.487721 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM products;
  );
[0m09:57:25.491122 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: FROM customers;
                       ^

[0m09:57:25.491415 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: ROLLBACK
[0m09:57:25.499671 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: FROM products;
                      ^

[0m09:57:25.500040 [debug] [Thread-3 (]: SQL status: BEGIN in 0.115 seconds
[0m09:57:25.500388 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: ROLLBACK
[0m09:57:25.500743 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:57:25.501147 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM sales;
  );
[0m09:57:25.502669 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m09:57:25.506773 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM customers;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:57:25.508027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857b170>]}
[0m09:57:25.508559 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.19s]
[0m09:57:25.509075 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:57:25.511138 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m09:57:25.512377 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24: FROM sales;
                   ^

[0m09:57:25.512693 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: ROLLBACK
[0m09:57:25.513865 [debug] [Thread-2 (]: Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM products;
                        ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:57:25.514190 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109619dc0>]}
[0m09:57:25.514643 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.20s]
[0m09:57:25.515079 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m09:57:25.523885 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m09:57:25.525865 [debug] [Thread-3 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM sales;
                     ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:57:25.526184 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e3d70>]}
[0m09:57:25.526601 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_sales .......................... [[31mERROR[0m in 0.21s]
[0m09:57:25.527029 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m09:57:25.527660 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m09:57:25.527989 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m09:57:25.528335 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m09:57:25.528652 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.orders_by_customer ................................. [[33mSKIP[0m]
[0m09:57:25.529016 [info ] [Thread-1 (]: 5 of 6 SKIP relation public.orders_by_day ...................................... [[33mSKIP[0m]
[0m09:57:25.529335 [info ] [Thread-2 (]: 6 of 6 SKIP relation public.product_performance ................................ [[33mSKIP[0m]
[0m09:57:25.529702 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m09:57:25.530048 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m09:57:25.530381 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m09:57:25.531349 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.531619 [debug] [MainThread]: On master: BEGIN
[0m09:57:25.531857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:25.643923 [debug] [MainThread]: SQL status: BEGIN in 0.112 seconds
[0m09:57:25.644520 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.644931 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.645315 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.655785 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m09:57:25.656163 [debug] [MainThread]: On master: Close
[0m09:57:25.656743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:25.657097 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m09:57:25.657430 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_products' was properly closed.
[0m09:57:25.657747 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_sales' was properly closed.
[0m09:57:25.658217 [info ] [MainThread]: 
[0m09:57:25.658634 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m09:57:25.659830 [debug] [MainThread]: Command end result
[0m09:57:25.687411 [info ] [MainThread]: 
[0m09:57:25.687833 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:57:25.688105 [info ] [MainThread]: 
[0m09:57:25.688447 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM customers;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:57:25.688700 [info ] [MainThread]: 
[0m09:57:25.688985 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM products;
                        ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:57:25.689231 [info ] [MainThread]: 
[0m09:57:25.689510 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM sales;
                     ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:57:25.689751 [info ] [MainThread]: 
[0m09:57:25.690006 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 TOTAL=6
[0m09:57:25.691282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3996309, "process_user_time": 1.373889, "process_kernel_time": 0.15575, "process_mem_max_rss": "134873088", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:57:25.691775 [debug] [MainThread]: Command `dbt run` failed at 09:57:25.691703 after 1.40 seconds
[0m09:57:25.692125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aea270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a93260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fc350>]}
[0m09:57:25.692425 [debug] [MainThread]: Flushing usage events
[0m09:58:30.035221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d27f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1c0b0>]}


============================== 09:58:30.038634 | 304f6678-d684-4f6d-9887-a428fb1c79f5 ==============================
[0m09:58:30.038634 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:58:30.039011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:58:30.085032 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:58:30.085337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f3710>]}
[0m09:58:30.147817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10373bd70>]}
[0m09:58:30.184572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5aa50>]}
[0m09:58:30.185609 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:58:30.195860 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:58:30.262895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:58:30.263311 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_sales.sql
[0m09:58:30.263537 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_products.sql
[0m09:58:30.263745 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_customers.sql
[0m09:58:30.407090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:58:30.413538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f9460>]}
[0m09:58:30.465292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744cd40>]}
[0m09:58:30.465597 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:58:30.465791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037b34a0>]}
[0m09:58:30.466817 [info ] [MainThread]: 
[0m09:58:30.467125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:58:30.469541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:58:30.500658 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:58:30.500922 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:58:30.501091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:30.669920 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.169 seconds
[0m09:58:30.671679 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:58:30.673345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m09:58:30.673892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m09:58:30.679587 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:58:30.681231 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:58:30.681557 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:58:30.681846 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:58:30.682116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:30.682380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:30.795975 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m09:58:30.796617 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m09:58:30.797266 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:58:30.797775 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:58:30.798299 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:58:30.798895 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:58:30.811393 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m09:58:30.811918 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m09:58:30.814035 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:58:30.816097 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:58:30.827783 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:58:30.828258 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:58:30.836951 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:30.837555 [debug] [MainThread]: On master: BEGIN
[0m09:58:30.838017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:58:30.952113 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m09:58:30.953123 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:30.953866 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:58:30.968834 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m09:58:30.971650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bf680>]}
[0m09:58:30.972523 [debug] [MainThread]: On master: ROLLBACK
[0m09:58:30.983916 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:30.984656 [debug] [MainThread]: On master: BEGIN
[0m09:58:31.008255 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m09:58:31.009557 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.010320 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:31.010896 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.019898 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m09:58:31.020775 [debug] [MainThread]: On master: Close
[0m09:58:31.022293 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:58:31.023167 [info ] [MainThread]: 
[0m09:58:31.029134 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m09:58:31.029847 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m09:58:31.030475 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m09:58:31.031220 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m09:58:31.032022 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m09:58:31.033755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m09:58:31.033040 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m09:58:31.034608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m09:58:31.035531 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:58:31.036232 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m09:58:31.036877 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:58:31.045835 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:58:31.046363 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m09:58:31.050863 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:58:31.053707 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m09:58:31.054489 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:58:31.054927 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m09:58:31.072805 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m09:58:31.087937 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:58:31.089940 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:58:31.091848 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m09:58:31.092447 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.092714 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m09:58:31.092978 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.093190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:31.093410 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.093633 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m09:58:31.093966 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m09:58:31.094216 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:58:31.094450 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:58:31.208087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.115 seconds
[0m09:58:31.208570 [debug] [Thread-2 (]: SQL status: BEGIN in 0.114 seconds
[0m09:58:31.209014 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.209422 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.209823 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m09:58:31.210264 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m09:58:31.213150 [debug] [Thread-3 (]: SQL status: BEGIN in 0.119 seconds
[0m09:58:31.213552 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.213944 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m09:58:31.238748 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m09:58:31.245889 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m09:58:31.246312 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.036 seconds
[0m09:58:31.247651 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.250526 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.253205 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.253686 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:58:31.254047 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m09:58:31.254383 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m09:58:31.264427 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:31.264825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:31.277439 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m09:58:31.281442 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m09:58:31.282590 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m09:58:31.283620 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m09:58:31.283938 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.284222 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.284499 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.284774 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m09:58:31.285044 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m09:58:31.285306 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m09:58:31.305559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m09:58:31.305962 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m09:58:31.311776 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m09:58:31.312124 [debug] [Thread-3 (]: SQL status: COMMIT in 0.026 seconds
[0m09:58:31.314022 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m09:58:31.319532 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.321229 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m09:58:31.321668 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.321989 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m09:58:31.322397 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.322697 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m09:58:31.323054 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m09:58:31.332582 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m09:58:31.332870 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m09:58:31.334791 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m09:58:31.335107 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.012 seconds
[0m09:58:31.336152 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m09:58:31.337226 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m09:58:31.338389 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104feeff0>]}
[0m09:58:31.338973 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.30s]
[0m09:58:31.339369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107882bd0>]}
[0m09:58:31.339697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107883ec0>]}
[0m09:58:31.340093 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m09:58:31.340507 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.30s]
[0m09:58:31.340910 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:58:31.341401 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m09:58:31.341761 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:58:31.342224 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m09:58:31.342574 [info ] [Thread-4 (]: 4 of 6 START sql table model public.orders_by_customer ......................... [RUN]
[0m09:58:31.342885 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m09:58:31.343214 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m09:58:31.343461 [debug] [Thread-3 (]: Began running node model.ecommerce_project.product_performance
[0m09:58:31.343772 [info ] [Thread-2 (]: 5 of 6 START sql table model public.orders_by_day .............................. [RUN]
[0m09:58:31.344049 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m09:58:31.344344 [info ] [Thread-3 (]: 6 of 6 START sql table model public.product_performance ........................ [RUN]
[0m09:58:31.344624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_day)
[0m09:58:31.346550 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m09:58:31.346855 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.product_performance)
[0m09:58:31.347116 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m09:58:31.347461 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.product_performance
[0m09:58:31.349295 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m09:58:31.351107 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m09:58:31.351613 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m09:58:31.351920 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m09:58:31.363902 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.product_performance
[0m09:58:31.366784 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m09:58:31.368515 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m09:58:31.370097 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m09:58:31.370718 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.370961 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.371184 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.371389 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: BEGIN
[0m09:58:31.371596 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m09:58:31.371789 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m09:58:31.371982 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:58:31.372173 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:58:31.372374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:58:31.483733 [debug] [Thread-3 (]: SQL status: BEGIN in 0.112 seconds
[0m09:58:31.484171 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.484521 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m09:58:31.488098 [debug] [Thread-4 (]: SQL status: BEGIN in 0.116 seconds
[0m09:58:31.488413 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.488736 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m09:58:31.493197 [debug] [Thread-2 (]: SQL status: BEGIN in 0.121 seconds
[0m09:58:31.493530 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.493845 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m09:58:31.544820 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.056 seconds
[0m09:58:31.549408 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.550017 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.065 seconds
[0m09:58:31.550562 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.056 seconds
[0m09:58:31.551052 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m09:58:31.554519 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.557850 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.558410 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m09:58:31.558889 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m09:58:31.568074 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m09:58:31.568536 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:31.574848 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:58:31.575678 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m09:58:31.577259 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m09:58:31.580322 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m09:58:31.580763 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.581171 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.581528 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.581938 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m09:58:31.582328 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m09:58:31.582667 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m09:58:31.596680 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m09:58:31.645295 [debug] [Thread-3 (]: SQL status: COMMIT in 0.062 seconds
[0m09:58:31.645704 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m09:58:31.645966 [debug] [Thread-2 (]: SQL status: COMMIT in 0.063 seconds
[0m09:58:31.647318 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m09:58:31.649090 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.650340 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m09:58:31.650676 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.650922 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m09:58:31.651237 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.651469 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m09:58:31.651774 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m09:58:31.663981 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m09:58:31.664233 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m09:58:31.665263 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: Close
[0m09:58:31.665507 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.013 seconds
[0m09:58:31.666342 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m09:58:31.667244 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m09:58:31.667573 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742a210>]}
[0m09:58:31.667836 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107429670>]}
[0m09:58:31.668259 [info ] [Thread-3 (]: 6 of 6 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.32s]
[0m09:58:31.668539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742b020>]}
[0m09:58:31.668851 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.32s]
[0m09:58:31.669190 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.product_performance
[0m09:58:31.669495 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.32s]
[0m09:58:31.669815 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m09:58:31.670178 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m09:58:31.670924 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:31.671123 [debug] [MainThread]: On master: BEGIN
[0m09:58:31.671297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:58:31.784088 [debug] [MainThread]: SQL status: BEGIN in 0.113 seconds
[0m09:58:31.784548 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.784833 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:31.785100 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.795995 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m09:58:31.796324 [debug] [MainThread]: On master: Close
[0m09:58:31.796852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:31.797157 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m09:58:31.797434 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m09:58:31.797703 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m09:58:31.797963 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m09:58:31.798377 [info ] [MainThread]: 
[0m09:58:31.798733 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m09:58:31.800068 [debug] [MainThread]: Command end result
[0m09:58:31.823222 [info ] [MainThread]: 
[0m09:58:31.823592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:58:31.823841 [info ] [MainThread]: 
[0m09:58:31.824085 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:58:31.825964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.830401, "process_user_time": 1.55683, "process_kernel_time": 0.195031, "process_mem_max_rss": "136577024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:58:31.826359 [debug] [MainThread]: Command `dbt run` succeeded at 09:58:31.826295 after 1.83 seconds
[0m09:58:31.826634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d25640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071267b0>]}
[0m09:58:31.826899 [debug] [MainThread]: Flushing usage events
[0m09:58:55.552238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1ab70>]}


============================== 09:58:55.555379 | c1ff4414-3dfc-4358-89ff-8ff2b7027a79 ==============================
[0m09:58:55.555379 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:58:55.555739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:58:55.601451 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:58:55.601765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068cf4d0>]}
[0m09:58:55.665131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068eb2f0>]}
[0m09:58:55.701492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106272330>]}
[0m09:58:55.702128 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:58:55.712372 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:58:55.779041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:58:55.779302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:58:55.782160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:58:55.802464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106531910>]}
[0m09:58:55.862881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e6840>]}
[0m09:58:55.863190 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:58:55.863389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bf7d0>]}
[0m09:58:55.864286 [info ] [MainThread]: 
[0m09:58:55.864485 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:58:55.865423 [debug] [MainThread]: Command end result
[0m09:58:55.879186 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.367541, "process_user_time": 1.019725, "process_kernel_time": 0.143396, "process_mem_max_rss": "118718464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:58:55.879533 [debug] [MainThread]: Command `dbt test` succeeded at 09:58:55.879486 after 0.37 seconds
[0m09:58:55.879759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106823b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051deea0>]}
[0m09:58:55.879953 [debug] [MainThread]: Flushing usage events
[0m09:59:08.091691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106270200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106270170>]}


============================== 09:59:08.094220 | 34a76b21-d77d-48ad-b6f2-11f5c340b395 ==============================
[0m09:59:08.094220 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:59:08.094570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:08.130043 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:59:08.130348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742fb30>]}
[0m09:59:08.193041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742eb10>]}
[0m09:59:08.229139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742f740>]}
[0m09:59:08.229631 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:59:08.238327 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:59:08.300716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:59:08.300978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:59:08.303807 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:59:08.324191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107366030>]}
[0m09:59:08.374498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d2930>]}
[0m09:59:08.374790 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:59:08.374984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107973e60>]}
[0m09:59:08.375970 [info ] [MainThread]: 
[0m09:59:08.376292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:59:08.376745 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:59:08.408227 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:59:08.408500 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:59:08.408682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:08.589307 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.180 seconds
[0m09:59:08.590902 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:59:08.591643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now create_d9snqvovhsjpqs_snapshots)
[0m09:59:08.592083 [debug] [ThreadPool]: Creating schema "database: "d9snqvovhsjpqs"
schema: "snapshots"
"
[0m09:59:08.597216 [debug] [ThreadPool]: Using postgres connection "create_d9snqvovhsjpqs_snapshots"
[0m09:59:08.597564 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:59:08.597846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:08.706585 [debug] [ThreadPool]: SQL status: BEGIN in 0.109 seconds
[0m09:59:08.707452 [debug] [ThreadPool]: Using postgres connection "create_d9snqvovhsjpqs_snapshots"
[0m09:59:08.708095 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_d9snqvovhsjpqs_snapshots"} */
create schema if not exists "snapshots"
[0m09:59:08.728028 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.019 seconds
[0m09:59:08.730660 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: COMMIT
[0m09:59:08.731285 [debug] [ThreadPool]: Using postgres connection "create_d9snqvovhsjpqs_snapshots"
[0m09:59:08.731786 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: COMMIT
[0m09:59:08.744246 [debug] [ThreadPool]: SQL status: COMMIT in 0.012 seconds
[0m09:59:08.744939 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: Close
[0m09:59:08.754610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_d9snqvovhsjpqs_snapshots, now list_d9snqvovhsjpqs_snapshots)
[0m09:59:08.761716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m09:59:08.764311 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:59:08.768218 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:59:08.768698 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:59:08.769101 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:59:08.769469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:08.769826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:08.887811 [debug] [ThreadPool]: SQL status: BEGIN in 0.118 seconds
[0m09:59:08.888805 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:59:08.889927 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:59:08.890765 [debug] [ThreadPool]: SQL status: BEGIN in 0.121 seconds
[0m09:59:08.891331 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:59:08.891836 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:59:08.910368 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.020 seconds
[0m09:59:08.913939 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:59:08.915011 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m09:59:08.917116 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:59:08.926425 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:59:08.927317 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:59:08.936658 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:08.937334 [debug] [MainThread]: On master: BEGIN
[0m09:59:08.937815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:09.063828 [debug] [MainThread]: SQL status: BEGIN in 0.126 seconds
[0m09:59:09.064733 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.065534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:59:09.085916 [debug] [MainThread]: SQL status: SELECT 3 in 0.019 seconds
[0m09:59:09.090706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ccc80>]}
[0m09:59:09.091740 [debug] [MainThread]: On master: ROLLBACK
[0m09:59:09.105148 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.105885 [debug] [MainThread]: On master: BEGIN
[0m09:59:09.132053 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m09:59:09.133370 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.134338 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.135267 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.147731 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m09:59:09.148359 [debug] [MainThread]: On master: Close
[0m09:59:09.149723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:59:09.150407 [info ] [MainThread]: 
[0m09:59:09.155605 [debug] [Thread-1 (]: Began running node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.156579 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.sales_snapshot ................................. [RUN]
[0m09:59:09.157701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now snapshot.ecommerce_project.sales_snapshot)
[0m09:59:09.158288 [debug] [Thread-1 (]: Began compiling node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.169620 [debug] [Thread-1 (]: Began executing node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.225367 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.225745 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id,
        order_date as dbt_updated_at,
        order_date as dbt_valid_from,
        nullif(order_date, order_date) as dbt_valid_to
    from (
        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m09:59:09.225991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:09.349993 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.124 seconds
[0m09:59:09.357387 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.357871 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m09:59:09.374594 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.016 seconds
[0m09:59:09.375259 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.376419 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.376850 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: BEGIN
[0m09:59:09.387800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:59:09.388249 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.388707 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      
  
    

  create  table "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id,
        order_date as dbt_updated_at,
        order_date as dbt_valid_from,
        nullif(order_date, order_date) as dbt_valid_to
    from (
        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"

    ) sbq



  );
  
  
[0m09:59:09.419310 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.030 seconds
[0m09:59:09.447043 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m09:59:09.447632 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.448037 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m09:59:09.463503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m09:59:09.465685 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: Close
[0m09:59:09.467871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c77200>]}
[0m09:59:09.468904 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.sales_snapshot ................................. [[32mSELECT 1000[0m in 0.31s]
[0m09:59:09.469643 [debug] [Thread-1 (]: Finished running node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.470899 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.471254 [debug] [MainThread]: On master: BEGIN
[0m09:59:09.471565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:09.591494 [debug] [MainThread]: SQL status: BEGIN in 0.120 seconds
[0m09:59:09.592961 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.593577 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.594348 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.607395 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m09:59:09.608308 [debug] [MainThread]: On master: Close
[0m09:59:09.609601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:09.610174 [debug] [MainThread]: Connection 'snapshot.ecommerce_project.sales_snapshot' was properly closed.
[0m09:59:09.610692 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m09:59:09.611544 [info ] [MainThread]: 
[0m09:59:09.612330 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m09:59:09.613618 [debug] [MainThread]: Command end result
[0m09:59:09.649350 [info ] [MainThread]: 
[0m09:59:09.649876 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:09.650206 [info ] [MainThread]: 
[0m09:59:09.650523 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:59:09.652096 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.5995879, "process_user_time": 1.329639, "process_kernel_time": 0.157388, "process_mem_max_rss": "130924544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:59:09.652646 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:59:09.652565 after 1.60 seconds
[0m09:59:09.653026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849af00>]}
[0m09:59:09.653378 [debug] [MainThread]: Flushing usage events
[0m11:53:40.153738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106297dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105490b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106117fb0>]}


============================== 11:53:40.156962 | 0cecca54-21bd-4530-b3bc-a148eadc00fb ==============================
[0m11:53:40.156962 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:53:40.157469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:40.197115 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:53:40.197411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106677a40>]}
[0m11:53:40.274071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106587e00>]}
[0m11:53:40.310831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105493ef0>]}
[0m11:53:40.311590 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:53:40.328580 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:53:40.399429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:40.399708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:40.402650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:53:40.422776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664bfb0>]}
[0m11:53:40.478722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a728a0>]}
[0m11:53:40.479040 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m11:53:40.479231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b99070>]}
[0m11:53:40.480276 [info ] [MainThread]: 
[0m11:53:40.480590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:40.482693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m11:53:40.515704 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m11:53:40.515968 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m11:53:40.516141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:40.675736 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.159 seconds
[0m11:53:40.677946 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m11:53:40.679831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m11:53:40.680397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m11:53:40.687262 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:53:40.689066 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:53:40.689410 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m11:53:40.689700 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m11:53:40.689973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:40.690232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:40.806151 [debug] [ThreadPool]: SQL status: BEGIN in 0.116 seconds
[0m11:53:40.807004 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m11:53:40.807582 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:53:40.808195 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:53:40.808853 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:53:40.809625 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:53:40.826011 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m11:53:40.829232 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m11:53:40.830045 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.020 seconds
[0m11:53:40.832477 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m11:53:40.842026 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m11:53:40.842593 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m11:53:40.854875 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:40.855370 [debug] [MainThread]: On master: BEGIN
[0m11:53:40.855746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:40.974608 [debug] [MainThread]: SQL status: BEGIN in 0.119 seconds
[0m11:53:40.975272 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:40.975918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:53:40.993339 [debug] [MainThread]: SQL status: SELECT 3 in 0.017 seconds
[0m11:53:40.996449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295d30>]}
[0m11:53:40.997185 [debug] [MainThread]: On master: ROLLBACK
[0m11:53:41.006833 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.007340 [debug] [MainThread]: On master: BEGIN
[0m11:53:41.030273 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m11:53:41.031531 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.032281 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.032910 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.045687 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m11:53:41.046647 [debug] [MainThread]: On master: Close
[0m11:53:41.048291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:53:41.049156 [info ] [MainThread]: 
[0m11:53:41.054359 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m11:53:41.055273 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m11:53:41.056274 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m11:53:41.057169 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m11:53:41.057981 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m11:53:41.058694 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m11:53:41.059434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m11:53:41.060032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m11:53:41.060692 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m11:53:41.061230 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m11:53:41.061742 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m11:53:41.062233 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m11:53:41.072523 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m11:53:41.075801 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m11:53:41.078585 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m11:53:41.079731 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m11:53:41.080179 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m11:53:41.080603 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m11:53:41.116157 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m11:53:41.118944 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m11:53:41.120999 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m11:53:41.121673 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.121962 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.122242 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.122474 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m11:53:41.122716 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m11:53:41.122930 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m11:53:41.123137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:41.123336 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:53:41.123529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:53:41.227276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.104 seconds
[0m11:53:41.227737 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.228094 [debug] [Thread-2 (]: SQL status: BEGIN in 0.105 seconds
[0m11:53:41.228472 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m11:53:41.228860 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.229260 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m11:53:41.237353 [debug] [Thread-3 (]: SQL status: BEGIN in 0.114 seconds
[0m11:53:41.237751 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.238146 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m11:53:41.253259 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m11:53:41.260750 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.261179 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m11:53:41.261552 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:53:41.265618 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.265986 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m11:53:41.266444 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m11:53:41.269190 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.269626 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m11:53:41.275821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m11:53:41.278285 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.278650 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:53:41.280244 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m11:53:41.282625 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.283037 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:53:41.283381 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m11:53:41.285822 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.286147 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m11:53:41.287537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m11:53:41.298722 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m11:53:41.302715 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m11:53:41.302997 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m11:53:41.304289 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m11:53:41.304629 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.305787 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m11:53:41.306162 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.306607 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m11:53:41.306910 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.307158 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m11:53:41.307447 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m11:53:41.321155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m11:53:41.326186 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m11:53:41.326609 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m11:53:41.327010 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m11:53:41.330884 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.332528 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m11:53:41.334129 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m11:53:41.334441 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m11:53:41.334867 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.335263 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.335688 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m11:53:41.336009 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m11:53:41.345968 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m11:53:41.347835 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m11:53:41.348962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7f290>]}
[0m11:53:41.349413 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m11:53:41.349828 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m11:53:41.350835 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.014 seconds
[0m11:53:41.351758 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m11:53:41.352026 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.016 seconds
[0m11:53:41.352957 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m11:53:41.353284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107115220>]}
[0m11:53:41.353614 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cff20>]}
[0m11:53:41.353984 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m11:53:41.354404 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.29s]
[0m11:53:41.354759 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m11:53:41.355062 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m11:53:41.356199 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m11:53:41.356513 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m11:53:41.356803 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m11:53:41.357105 [info ] [Thread-4 (]: 4 of 6 START sql table model public.orders_by_customer ......................... [RUN]
[0m11:53:41.357418 [info ] [Thread-1 (]: 5 of 6 START sql table model public.orders_by_day .............................. [RUN]
[0m11:53:41.357848 [info ] [Thread-2 (]: 6 of 6 START sql table model public.product_performance ........................ [RUN]
[0m11:53:41.358693 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m11:53:41.359042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_day)
[0m11:53:41.359302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m11:53:41.359580 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m11:53:41.359890 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m11:53:41.360130 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m11:53:41.361968 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m11:53:41.363469 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m11:53:41.365207 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m11:53:41.366646 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m11:53:41.366902 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m11:53:41.367117 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m11:53:41.381507 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m11:53:41.383334 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m11:53:41.384810 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m11:53:41.385296 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.385504 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m11:53:41.385712 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.385924 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.386110 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:53:41.386300 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m11:53:41.386478 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m11:53:41.386737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:41.386919 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:53:41.483317 [debug] [Thread-4 (]: SQL status: BEGIN in 0.097 seconds
[0m11:53:41.483792 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.484130 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m11:53:41.504656 [debug] [Thread-2 (]: SQL status: BEGIN in 0.118 seconds
[0m11:53:41.505021 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.505364 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m11:53:41.505745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m11:53:41.506154 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.506481 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m11:53:41.516223 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.032 seconds
[0m11:53:41.519174 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.519543 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m11:53:41.531004 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m11:53:41.533619 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.534018 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m11:53:41.540384 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.034 seconds
[0m11:53:41.543384 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.543774 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.037 seconds
[0m11:53:41.544146 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m11:53:41.544558 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m11:53:41.547220 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.552464 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m11:53:41.552924 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m11:53:41.553269 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.553645 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m11:53:41.565037 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m11:53:41.567553 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.567923 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m11:53:41.568261 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m11:53:41.568563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m11:53:41.570804 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m11:53:41.573268 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.575869 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.576252 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m11:53:41.576570 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m11:53:41.580791 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m11:53:41.582081 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m11:53:41.582420 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.582731 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m11:53:41.589796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m11:53:41.591141 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m11:53:41.591485 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.591795 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m11:53:41.593294 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.016 seconds
[0m11:53:41.594473 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m11:53:41.595104 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b75f0>]}
[0m11:53:41.595689 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.24s]
[0m11:53:41.596242 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m11:53:41.597401 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m11:53:41.600972 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m11:53:41.601499 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.601834 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m11:53:41.602718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m11:53:41.604248 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m11:53:41.604743 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.605034 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m11:53:41.616436 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.014 seconds
[0m11:53:41.617868 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m11:53:41.618439 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071351f0>]}
[0m11:53:41.618932 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.26s]
[0m11:53:41.619396 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m11:53:41.623530 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m11:53:41.624601 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m11:53:41.625028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107136210>]}
[0m11:53:41.625461 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.27s]
[0m11:53:41.625884 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m11:53:41.626808 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.627071 [debug] [MainThread]: On master: BEGIN
[0m11:53:41.627302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:53:41.739884 [debug] [MainThread]: SQL status: BEGIN in 0.112 seconds
[0m11:53:41.740606 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.741097 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.741553 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.751741 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m11:53:41.752194 [debug] [MainThread]: On master: Close
[0m11:53:41.752909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:41.753339 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m11:53:41.753745 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m11:53:41.754133 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_sales' was properly closed.
[0m11:53:41.754513 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m11:53:41.755076 [info ] [MainThread]: 
[0m11:53:41.755588 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m11:53:41.757424 [debug] [MainThread]: Command end result
[0m11:53:41.801447 [info ] [MainThread]: 
[0m11:53:41.802299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:41.802716 [info ] [MainThread]: 
[0m11:53:41.806729 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:53:41.816854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.705324, "process_user_time": 1.443455, "process_kernel_time": 0.213564, "process_mem_max_rss": "127516672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:41.817604 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:41.817492 after 1.71 seconds
[0m11:53:41.818057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573d2e0>]}
[0m11:53:41.818485 [debug] [MainThread]: Flushing usage events
[0m11:53:52.067234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dce0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106857fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106857e90>]}


============================== 11:53:52.070681 | db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07 ==============================
[0m11:53:52.070681 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:53:52.071032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:53:52.108334 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:53:52.108642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068860f0>]}
[0m11:53:52.174669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106caa690>]}
[0m11:53:52.211688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068feba0>]}
[0m11:53:52.212341 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:53:52.221128 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:53:52.288311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:52.288576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:52.291451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:53:52.311594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccb4a0>]}
[0m11:53:52.377919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713f170>]}
[0m11:53:52.378287 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m11:53:52.378483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068579b0>]}
[0m11:53:52.379437 [info ] [MainThread]: 
[0m11:53:52.379642 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:53:52.380598 [debug] [MainThread]: Command end result
[0m11:53:52.395081 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.36842787, "process_user_time": 1.003717, "process_kernel_time": 0.097488, "process_mem_max_rss": "119750656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:52.395461 [debug] [MainThread]: Command `dbt test` succeeded at 11:53:52.395410 after 0.37 seconds
[0m11:53:52.395696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dce0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106887560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4d730>]}
[0m11:53:52.395886 [debug] [MainThread]: Flushing usage events
[0m11:53:59.450286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a392b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105994440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059943b0>]}


============================== 11:53:59.452774 | a537a1ae-3ccf-4d14-9c45-caa981091474 ==============================
[0m11:53:59.452774 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:53:59.453132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:59.487099 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:53:59.487402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5bdd0>]}
[0m11:53:59.550669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bf9e0>]}
[0m11:53:59.587297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b07e30>]}
[0m11:53:59.587793 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:53:59.596721 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:53:59.658921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:59.659179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:59.661997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:53:59.681860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed33b0>]}
[0m11:53:59.733578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fae870>]}
[0m11:53:59.733889 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m11:53:59.734103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107147e90>]}
[0m11:53:59.735071 [info ] [MainThread]: 
[0m11:53:59.735399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:59.735837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m11:53:59.767555 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m11:53:59.767826 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m11:53:59.768000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:59.921892 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.154 seconds
[0m11:53:59.923963 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m11:53:59.929230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m11:53:59.929841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m11:53:59.936381 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:53:59.938016 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:53:59.938372 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m11:53:59.938674 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m11:53:59.938953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:59.939222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:00.056544 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m11:54:00.057247 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:54:00.057888 [debug] [ThreadPool]: SQL status: BEGIN in 0.119 seconds
[0m11:54:00.058635 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:54:00.059281 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:54:00.059894 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:54:00.072561 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m11:54:00.075185 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m11:54:00.082609 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.022 seconds
[0m11:54:00.085113 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m11:54:00.085662 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m11:54:00.098662 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m11:54:00.111257 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.111933 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.112356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:00.229310 [debug] [MainThread]: SQL status: BEGIN in 0.117 seconds
[0m11:54:00.230636 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.231754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:54:00.251498 [debug] [MainThread]: SQL status: SELECT 3 in 0.018 seconds
[0m11:54:00.257326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6b140>]}
[0m11:54:00.258372 [debug] [MainThread]: On master: ROLLBACK
[0m11:54:00.269233 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.270084 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.293302 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m11:54:00.294614 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.295586 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.296535 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.309300 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m11:54:00.310972 [debug] [MainThread]: On master: Close
[0m11:54:00.313027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:00.314200 [info ] [MainThread]: 
[0m11:54:00.320519 [debug] [Thread-1 (]: Began running node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.321584 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.sales_snapshot ................................. [RUN]
[0m11:54:00.322369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now snapshot.ecommerce_project.sales_snapshot)
[0m11:54:00.322973 [debug] [Thread-1 (]: Began compiling node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.334569 [debug] [Thread-1 (]: Began executing node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.385340 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.385716 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: BEGIN
[0m11:54:00.385963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:00.499016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.113 seconds
[0m11:54:00.499624 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.500166 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:54:00.537066 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.036 seconds
[0m11:54:00.577180 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.577762 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

        
  
    

  create temporary table "sales_snapshot__dbt_tmp115400569448"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m11:54:00.604063 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.026 seconds
[0m11:54:00.607032 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.607460 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp115400569448'
        
      order by ordinal_position

  
[0m11:54:00.621290 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.013 seconds
[0m11:54:00.624828 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.625218 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:54:00.640802 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.015 seconds
[0m11:54:00.644076 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.644552 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp115400569448'
        
      order by ordinal_position

  
[0m11:54:00.656818 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m11:54:00.659911 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.660473 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:54:00.672951 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.012 seconds
[0m11:54:00.683501 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.683987 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp115400569448'
        
      order by ordinal_position

  
[0m11:54:00.696623 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m11:54:00.714620 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.715106 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m11:54:00.727064 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m11:54:00.732621 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.733021 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m11:54:00.742670 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m11:54:00.743164 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.744318 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.744722 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      update "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sales_snapshot__dbt_tmp115400569448" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_valid_to is null;

    insert into "d9snqvovhsjpqs"."snapshots"."sales_snapshot" ("order_id", "customer_id", "product_id", "order_date", "quantity", "total_price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."product_id",DBT_INTERNAL_SOURCE."order_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."total_price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sales_snapshot__dbt_tmp115400569448" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m11:54:00.757732 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.013 seconds
[0m11:54:00.773363 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m11:54:00.773747 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.774035 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m11:54:00.791242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m11:54:00.794709 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: Close
[0m11:54:00.796221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a30b0>]}
[0m11:54:00.797015 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.sales_snapshot ................................. [[32mINSERT 0 0[0m in 0.47s]
[0m11:54:00.797612 [debug] [Thread-1 (]: Finished running node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.798736 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.799037 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.799304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:54:00.915207 [debug] [MainThread]: SQL status: BEGIN in 0.116 seconds
[0m11:54:00.915966 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.916444 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.916885 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.927212 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m11:54:00.927675 [debug] [MainThread]: On master: Close
[0m11:54:00.928448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:00.928885 [debug] [MainThread]: Connection 'snapshot.ecommerce_project.sales_snapshot' was properly closed.
[0m11:54:00.929285 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m11:54:00.929736 [info ] [MainThread]: 
[0m11:54:00.930251 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m11:54:00.931220 [debug] [MainThread]: Command end result
[0m11:54:00.960684 [info ] [MainThread]: 
[0m11:54:00.961171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:00.961486 [info ] [MainThread]: 
[0m11:54:00.961808 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:54:00.963199 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.5510751, "process_user_time": 1.345932, "process_kernel_time": 0.150261, "process_mem_max_rss": "127991808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:54:00.963746 [debug] [MainThread]: Command `dbt snapshot` succeeded at 11:54:00.963670 after 1.55 seconds
[0m11:54:00.964075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b23b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059943b0>]}
[0m11:54:00.964389 [debug] [MainThread]: Flushing usage events
[0m13:51:26.452519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033e22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb4a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb4410>]}


============================== 13:51:26.456126 | 11474948-bb9c-4e17-bee5-44d58be91377 ==============================
[0m13:51:26.456126 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:51:26.456541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:51:26.501805 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:51:26.502126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec6db0>]}
[0m13:51:26.586779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b77ce0>]}
[0m13:51:26.626433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dbc080>]}
[0m13:51:26.627294 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:51:26.642005 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:51:26.717505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:26.717795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:26.720859 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m13:51:26.743179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052faea0>]}
[0m13:51:26.804955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d1550>]}
[0m13:51:26.805280 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m13:51:26.805492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b99cd0>]}
[0m13:51:26.806627 [info ] [MainThread]: 
[0m13:51:26.806973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:51:26.809194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m13:51:26.853740 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m13:51:26.854157 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m13:51:26.854344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:26.995130 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.141 seconds
[0m13:51:26.996965 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m13:51:26.998770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m13:51:26.999465 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m13:51:27.005808 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m13:51:27.007604 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m13:51:27.007953 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m13:51:27.008249 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m13:51:27.008532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:27.008803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:27.104627 [debug] [ThreadPool]: SQL status: BEGIN in 0.096 seconds
[0m13:51:27.105199 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m13:51:27.105598 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:51:27.119979 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m13:51:27.122007 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m13:51:27.122450 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m13:51:27.122939 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m13:51:27.123382 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:51:27.132551 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m13:51:27.137608 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m13:51:27.139249 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m13:51:27.150078 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m13:51:27.157332 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:27.157914 [debug] [MainThread]: On master: BEGIN
[0m13:51:27.158315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:27.269481 [debug] [MainThread]: SQL status: BEGIN in 0.111 seconds
[0m13:51:27.270252 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:27.270865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:51:27.287117 [debug] [MainThread]: SQL status: SELECT 3 in 0.016 seconds
[0m13:51:27.291924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3f680>]}
[0m13:51:27.292821 [debug] [MainThread]: On master: ROLLBACK
[0m13:51:27.305509 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:27.306289 [debug] [MainThread]: On master: BEGIN
[0m13:51:27.329644 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m13:51:27.330423 [debug] [MainThread]: On master: COMMIT
[0m13:51:27.330881 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:27.331694 [debug] [MainThread]: On master: COMMIT
[0m13:51:27.341466 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m13:51:27.342260 [debug] [MainThread]: On master: Close
[0m13:51:27.343455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:51:27.344708 [info ] [MainThread]: 
[0m13:51:27.349896 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m13:51:27.350921 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m13:51:27.351367 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m13:51:27.351937 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m13:51:27.352458 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m13:51:27.352845 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m13:51:27.353508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m13:51:27.353917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m13:51:27.354416 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m13:51:27.354852 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m13:51:27.355183 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m13:51:27.355478 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m13:51:27.362584 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m13:51:27.365217 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m13:51:27.367890 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m13:51:27.369015 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m13:51:27.369339 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m13:51:27.369663 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m13:51:27.409331 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m13:51:27.411269 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m13:51:27.413363 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m13:51:27.414155 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:51:27.414457 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:51:27.414752 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m13:51:27.415032 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m13:51:27.415286 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:51:27.415554 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:51:27.415799 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:51:27.416038 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m13:51:27.416463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:27.508406 [debug] [Thread-2 (]: SQL status: BEGIN in 0.093 seconds
[0m13:51:27.508854 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:51:27.509149 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m13:51:27.512502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m13:51:27.512781 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:51:27.513055 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m13:51:27.525206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.110 seconds
[0m13:51:27.525530 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:51:27.525836 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m13:51:27.536761 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m13:51:27.541980 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:51:27.542309 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m13:51:27.542654 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:51:27.544910 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:51:27.545341 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:51:27.549046 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m13:51:27.552393 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:51:27.552727 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m13:51:27.553036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m13:51:27.555245 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:51:27.555567 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:51:27.557758 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m13:51:27.559997 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:51:27.560362 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:51:27.562326 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m13:51:27.565177 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:51:27.565544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m13:51:27.565901 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m13:51:27.572558 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m13:51:27.580473 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m13:51:27.581674 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m13:51:27.582016 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:51:27.582287 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:51:27.582547 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m13:51:27.582796 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m13:51:27.589511 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m13:51:27.590493 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m13:51:27.590764 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:51:27.591005 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m13:51:27.593858 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m13:51:27.594181 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m13:51:27.599361 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m13:51:27.601118 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m13:51:27.604888 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:51:27.605236 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m13:51:27.605611 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:51:27.605890 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m13:51:27.607299 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m13:51:27.607544 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m13:51:27.607916 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:51:27.608225 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m13:51:27.620547 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.013 seconds
[0m13:51:27.620828 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.012 seconds
[0m13:51:27.622485 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m13:51:27.622731 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.015 seconds
[0m13:51:27.623617 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m13:51:27.624555 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m13:51:27.625482 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b6d20>]}
[0m13:51:27.625892 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b66f0>]}
[0m13:51:27.626303 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.27s]
[0m13:51:27.626817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591cd10>]}
[0m13:51:27.627180 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.27s]
[0m13:51:27.627577 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m13:51:27.627916 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m13:51:27.628272 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m13:51:27.628824 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m13:51:27.629407 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m13:51:27.630023 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m13:51:27.630617 [debug] [Thread-3 (]: Began running node model.ecommerce_project.product_performance
[0m13:51:27.629790 [info ] [Thread-4 (]: 4 of 6 START sql table model public.orders_by_customer ......................... [RUN]
[0m13:51:27.630425 [info ] [Thread-2 (]: 5 of 6 START sql table model public.orders_by_day .............................. [RUN]
[0m13:51:27.631460 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m13:51:27.631804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_day)
[0m13:51:27.631027 [info ] [Thread-3 (]: 6 of 6 START sql table model public.product_performance ........................ [RUN]
[0m13:51:27.632173 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m13:51:27.632414 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m13:51:27.632726 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.product_performance)
[0m13:51:27.635112 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m13:51:27.636647 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m13:51:27.636908 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.product_performance
[0m13:51:27.638569 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m13:51:27.638951 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m13:51:27.646770 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m13:51:27.663937 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m13:51:27.665861 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m13:51:27.666200 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.product_performance
[0m13:51:27.668647 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m13:51:27.669195 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:51:27.669423 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:51:27.669684 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m13:51:27.669884 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:51:27.670089 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m13:51:27.670299 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:51:27.670495 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: BEGIN
[0m13:51:27.670710 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:51:27.670991 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:51:27.780338 [debug] [Thread-2 (]: SQL status: BEGIN in 0.110 seconds
[0m13:51:27.780818 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:51:27.781146 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m13:51:27.793775 [debug] [Thread-4 (]: SQL status: BEGIN in 0.123 seconds
[0m13:51:27.794160 [debug] [Thread-3 (]: SQL status: BEGIN in 0.123 seconds
[0m13:51:27.794504 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:51:27.794801 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:51:27.795128 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m13:51:27.795634 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m13:51:27.895563 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.114 seconds
[0m13:51:27.896238 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.100 seconds
[0m13:51:27.900649 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:51:27.903669 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:51:27.904048 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.108 seconds
[0m13:51:27.904437 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m13:51:27.904775 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m13:51:27.907044 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:51:27.907532 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m13:51:27.920148 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m13:51:27.920565 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m13:51:27.920908 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m13:51:27.925716 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m13:51:27.927027 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m13:51:27.928250 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m13:51:27.928667 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:51:27.929048 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:51:27.929379 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:51:27.929703 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m13:51:27.930024 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m13:51:27.930339 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m13:51:27.943077 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m13:51:27.943467 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m13:51:27.943783 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m13:51:27.945708 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m13:51:27.947349 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m13:51:27.948938 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m13:51:27.951405 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:51:27.951881 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:51:27.952299 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:51:27.952650 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m13:51:27.953028 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m13:51:27.953382 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m13:51:27.964547 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m13:51:27.964948 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.011 seconds
[0m13:51:27.965314 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m13:51:27.966617 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m13:51:27.967822 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m13:51:27.969175 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: Close
[0m13:51:27.969794 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8d640>]}
[0m13:51:27.970334 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.34s]
[0m13:51:27.970756 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a50170>]}
[0m13:51:27.971127 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11474948-bb9c-4e17-bee5-44d58be91377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5f2f0>]}
[0m13:51:27.971612 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m13:51:27.972086 [info ] [Thread-3 (]: 6 of 6 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.34s]
[0m13:51:27.972554 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.34s]
[0m13:51:27.973178 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.product_performance
[0m13:51:27.973632 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m13:51:27.974744 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:27.975037 [debug] [MainThread]: On master: BEGIN
[0m13:51:27.975293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:28.085563 [debug] [MainThread]: SQL status: BEGIN in 0.110 seconds
[0m13:51:28.086396 [debug] [MainThread]: On master: COMMIT
[0m13:51:28.087108 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:28.088621 [debug] [MainThread]: On master: COMMIT
[0m13:51:28.097511 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m13:51:28.098430 [debug] [MainThread]: On master: Close
[0m13:51:28.099354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:28.099813 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m13:51:28.100253 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m13:51:28.100715 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m13:51:28.101112 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m13:51:28.101691 [info ] [MainThread]: 
[0m13:51:28.102239 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m13:51:28.103374 [debug] [MainThread]: Command end result
[0m13:51:28.125807 [info ] [MainThread]: 
[0m13:51:28.126245 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:51:28.126540 [info ] [MainThread]: 
[0m13:51:28.126952 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:51:28.133287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.72697, "process_user_time": 1.501637, "process_kernel_time": 0.232086, "process_mem_max_rss": "128401408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:51:28.133958 [debug] [MainThread]: Command `dbt run` succeeded at 13:51:28.133864 after 1.73 seconds
[0m13:51:28.134418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105372ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033e22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb4a70>]}
[0m13:51:28.134995 [debug] [MainThread]: Flushing usage events
[0m13:56:37.028605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720c200>]}


============================== 13:56:37.032216 | 430d7f07-f0da-4060-bf56-4e7d742f00f1 ==============================
[0m13:56:37.032216 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:56:37.032604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:56:37.074109 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:56:37.074448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '430d7f07-f0da-4060-bf56-4e7d742f00f1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fadb0>]}
[0m13:56:37.144901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '430d7f07-f0da-4060-bf56-4e7d742f00f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b23cb0>]}
[0m13:56:37.183875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '430d7f07-f0da-4060-bf56-4e7d742f00f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b97c80>]}
[0m13:56:37.185288 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:56:37.197567 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:56:37.271943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:37.272242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:37.275335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m13:56:37.297429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '430d7f07-f0da-4060-bf56-4e7d742f00f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076eb3e0>]}
[0m13:56:37.355531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '430d7f07-f0da-4060-bf56-4e7d742f00f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771f020>]}
[0m13:56:37.355931 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m13:56:37.356168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '430d7f07-f0da-4060-bf56-4e7d742f00f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764d250>]}
[0m13:56:37.357439 [info ] [MainThread]: 
[0m13:56:37.357908 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:37.358638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m13:56:37.392669 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m13:56:37.392989 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m13:56:37.393175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:37.574245 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.181 seconds
[0m13:56:37.575999 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m13:56:37.581075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m13:56:37.581735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m13:56:37.588289 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m13:56:37.590606 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m13:56:37.591157 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m13:56:37.591534 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m13:56:37.591881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:37.592201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:37.706228 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m13:56:37.707088 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m13:56:37.707706 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:56:37.709973 [debug] [ThreadPool]: SQL status: BEGIN in 0.118 seconds
[0m13:56:37.710656 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m13:56:37.711244 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:56:37.721515 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m13:56:37.723883 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m13:56:37.724969 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.013 seconds
[0m13:56:37.726514 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m13:56:37.734259 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m13:56:37.737783 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m13:56:37.746302 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:37.746753 [debug] [MainThread]: On master: BEGIN
[0m13:56:37.747053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:37.861391 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m13:56:37.862157 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:37.862769 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:56:37.879898 [debug] [MainThread]: SQL status: SELECT 3 in 0.016 seconds
[0m13:56:37.883910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '430d7f07-f0da-4060-bf56-4e7d742f00f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b979b0>]}
[0m13:56:37.884576 [debug] [MainThread]: On master: ROLLBACK
[0m13:56:37.897346 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:37.898162 [debug] [MainThread]: On master: BEGIN
[0m13:56:37.921294 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m13:56:37.922031 [debug] [MainThread]: On master: COMMIT
[0m13:56:37.922482 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:37.923041 [debug] [MainThread]: On master: COMMIT
[0m13:56:37.933345 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m13:56:37.934092 [debug] [MainThread]: On master: Close
[0m13:56:37.934964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:37.935517 [info ] [MainThread]: 
[0m13:56:37.940154 [debug] [Thread-1 (]: Began running node snapshot.ecommerce_project.sales_snapshot
[0m13:56:37.940768 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.sales_snapshot ................................. [RUN]
[0m13:56:37.941211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now snapshot.ecommerce_project.sales_snapshot)
[0m13:56:37.941545 [debug] [Thread-1 (]: Began compiling node snapshot.ecommerce_project.sales_snapshot
[0m13:56:37.949146 [debug] [Thread-1 (]: Began executing node snapshot.ecommerce_project.sales_snapshot
[0m13:56:37.999649 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.000091 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: BEGIN
[0m13:56:38.000363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:38.100412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.100 seconds
[0m13:56:38.100851 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.101154 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m13:56:38.121379 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.020 seconds
[0m13:56:38.144893 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.145376 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

        
  
    

  create temporary table "sales_snapshot__dbt_tmp135638139071"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m13:56:38.169664 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.024 seconds
[0m13:56:38.171886 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.172223 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp135638139071'
        
      order by ordinal_position

  
[0m13:56:38.183220 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.011 seconds
[0m13:56:38.185980 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.186393 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m13:56:38.198872 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.012 seconds
[0m13:56:38.201406 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.201733 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp135638139071'
        
      order by ordinal_position

  
[0m13:56:38.214605 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.013 seconds
[0m13:56:38.217129 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.217578 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m13:56:38.230737 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.013 seconds
[0m13:56:38.237694 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.238080 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp135638139071'
        
      order by ordinal_position

  
[0m13:56:38.250682 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m13:56:38.265493 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.266025 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m13:56:38.276746 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m13:56:38.281542 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.281948 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m13:56:38.292799 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m13:56:38.293451 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.294919 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.295283 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      update "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sales_snapshot__dbt_tmp135638139071" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_valid_to is null;

    insert into "d9snqvovhsjpqs"."snapshots"."sales_snapshot" ("order_id", "customer_id", "product_id", "order_date", "quantity", "total_price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."product_id",DBT_INTERNAL_SOURCE."order_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."total_price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sales_snapshot__dbt_tmp135638139071" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:56:38.305360 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.010 seconds
[0m13:56:38.320037 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m13:56:38.320516 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m13:56:38.320863 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m13:56:38.336215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m13:56:38.339464 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: Close
[0m13:56:38.340747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '430d7f07-f0da-4060-bf56-4e7d742f00f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cb4d0>]}
[0m13:56:38.341386 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.sales_snapshot ................................. [[32mINSERT 0 0[0m in 0.40s]
[0m13:56:38.341892 [debug] [Thread-1 (]: Finished running node snapshot.ecommerce_project.sales_snapshot
[0m13:56:38.342914 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:38.343199 [debug] [MainThread]: On master: BEGIN
[0m13:56:38.343435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:38.457858 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m13:56:38.458741 [debug] [MainThread]: On master: COMMIT
[0m13:56:38.459245 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:38.459681 [debug] [MainThread]: On master: COMMIT
[0m13:56:38.469130 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m13:56:38.469910 [debug] [MainThread]: On master: Close
[0m13:56:38.470897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:38.471383 [debug] [MainThread]: Connection 'snapshot.ecommerce_project.sales_snapshot' was properly closed.
[0m13:56:38.471804 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m13:56:38.472380 [info ] [MainThread]: 
[0m13:56:38.472748 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m13:56:38.473292 [debug] [MainThread]: Command end result
[0m13:56:38.494994 [info ] [MainThread]: 
[0m13:56:38.495438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:38.495774 [info ] [MainThread]: 
[0m13:56:38.496072 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:56:38.498295 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.5139796, "process_user_time": 1.388319, "process_kernel_time": 0.183688, "process_mem_max_rss": "128827392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:56:38.498830 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:56:38.498757 after 1.51 seconds
[0m13:56:38.499178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c088c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106291400>]}
[0m13:56:38.499473 [debug] [MainThread]: Flushing usage events
[0m13:38:40.930613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f31940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104154350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041543e0>]}


============================== 13:38:40.934159 | 061ac5ae-4557-4e27-a600-9745fea751e3 ==============================
[0m13:38:40.934159 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:38:40.934532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tyler/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:38:40.989702 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:38:40.990002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c2db0>]}
[0m13:38:41.067083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c3980>]}
[0m13:38:41.103215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d59a0>]}
[0m13:38:41.103819 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:38:41.120060 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:38:41.191560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:41.191828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:41.194782 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m13:38:41.214991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105726e70>]}
[0m13:38:41.270919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105766e40>]}
[0m13:38:41.271222 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m13:38:41.271410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105706ae0>]}
[0m13:38:41.272459 [info ] [MainThread]: 
[0m13:38:41.272780 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:38:41.274873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m13:38:41.317344 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m13:38:41.317594 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m13:38:41.317765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:41.480932 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.163 seconds
[0m13:38:41.482744 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m13:38:41.484436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m13:38:41.485002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m13:38:41.490808 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m13:38:41.492282 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m13:38:41.492564 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m13:38:41.492819 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m13:38:41.493055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:41.493295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:41.607796 [debug] [ThreadPool]: SQL status: BEGIN in 0.115 seconds
[0m13:38:41.608371 [debug] [ThreadPool]: SQL status: BEGIN in 0.115 seconds
[0m13:38:41.608890 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m13:38:41.609299 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m13:38:41.609714 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:38:41.610174 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:38:41.623754 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.013 seconds
[0m13:38:41.625890 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m13:38:41.626338 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m13:38:41.627894 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m13:38:41.635646 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m13:38:41.639900 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m13:38:41.648049 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:41.648566 [debug] [MainThread]: On master: BEGIN
[0m13:38:41.648946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:41.747381 [debug] [MainThread]: SQL status: BEGIN in 0.098 seconds
[0m13:38:41.748286 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:41.748921 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:38:41.780178 [debug] [MainThread]: SQL status: SELECT 3 in 0.030 seconds
[0m13:38:41.787046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f622a0>]}
[0m13:38:41.788241 [debug] [MainThread]: On master: ROLLBACK
[0m13:38:41.799208 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:41.799819 [debug] [MainThread]: On master: BEGIN
[0m13:38:41.819671 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m13:38:41.821562 [debug] [MainThread]: On master: COMMIT
[0m13:38:41.822608 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:41.823555 [debug] [MainThread]: On master: COMMIT
[0m13:38:41.835314 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m13:38:41.836065 [debug] [MainThread]: On master: Close
[0m13:38:41.837372 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:41.838264 [info ] [MainThread]: 
[0m13:38:41.843441 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m13:38:41.844168 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m13:38:41.844748 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m13:38:41.845496 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m13:38:41.846317 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m13:38:41.847016 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m13:38:41.847682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m13:38:41.848264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m13:38:41.848904 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m13:38:41.849434 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m13:38:41.849964 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m13:38:41.850452 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m13:38:41.860637 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m13:38:41.863537 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m13:38:41.866271 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m13:38:41.867110 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m13:38:41.880361 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m13:38:41.880733 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m13:38:41.899422 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m13:38:41.901570 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m13:38:41.903567 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m13:38:41.904312 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:38:41.904595 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:38:41.904853 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:38:41.905104 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m13:38:41.905363 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m13:38:41.905604 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m13:38:41.905835 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:38:41.906060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:41.906288 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:38:42.007776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.102 seconds
[0m13:38:42.008262 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:38:42.008630 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m13:38:42.019759 [debug] [Thread-2 (]: SQL status: BEGIN in 0.113 seconds
[0m13:38:42.020138 [debug] [Thread-3 (]: SQL status: BEGIN in 0.114 seconds
[0m13:38:42.020440 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:38:42.020758 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:38:42.021089 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m13:38:42.021449 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m13:38:42.032264 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m13:38:42.039333 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:38:42.039718 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:38:42.045126 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m13:38:42.049216 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:38:42.049590 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m13:38:42.049924 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:38:42.052715 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:38:42.053108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m13:38:42.053482 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m13:38:42.055847 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:38:42.056255 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:38:42.064498 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m13:38:42.067022 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:38:42.067377 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:38:42.067715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m13:38:42.073666 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m13:38:42.080273 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m13:38:42.083523 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m13:38:42.085493 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:38:42.086455 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m13:38:42.086728 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:38:42.086991 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m13:38:42.087250 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:38:42.087494 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m13:38:42.087802 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m13:38:42.096363 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m13:38:42.097272 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m13:38:42.097527 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:38:42.097761 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m13:38:42.101428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m13:38:42.101719 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m13:38:42.106339 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m13:38:42.107795 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m13:38:42.111182 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:38:42.111454 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m13:38:42.111798 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:38:42.112047 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m13:38:42.113365 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m13:38:42.113592 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m13:38:42.113943 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:38:42.114214 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m13:38:42.126499 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.013 seconds
[0m13:38:42.128101 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m13:38:42.128377 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.014 seconds
[0m13:38:42.128627 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.014 seconds
[0m13:38:42.129899 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m13:38:42.130478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048133b0>]}
[0m13:38:42.131346 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m13:38:42.131781 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m13:38:42.132102 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8d7c0>]}
[0m13:38:42.132513 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m13:38:42.132792 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb3260>]}
[0m13:38:42.133153 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.28s]
[0m13:38:42.133600 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.28s]
[0m13:38:42.133963 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m13:38:42.134274 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m13:38:42.134772 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m13:38:42.135013 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m13:38:42.135258 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m13:38:42.135510 [info ] [Thread-4 (]: 4 of 6 START sql table model public.orders_by_customer ......................... [RUN]
[0m13:38:42.135791 [info ] [Thread-1 (]: 5 of 6 START sql table model public.orders_by_day .............................. [RUN]
[0m13:38:42.136059 [info ] [Thread-2 (]: 6 of 6 START sql table model public.product_performance ........................ [RUN]
[0m13:38:42.136347 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m13:38:42.136569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_day)
[0m13:38:42.136779 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m13:38:42.136990 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m13:38:42.137190 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m13:38:42.137385 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m13:38:42.139017 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m13:38:42.140403 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m13:38:42.141828 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m13:38:42.143255 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m13:38:42.143471 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m13:38:42.143693 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m13:38:42.157773 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m13:38:42.159470 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m13:38:42.161002 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m13:38:42.161480 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:38:42.161723 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:38:42.161925 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:38:42.162111 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m13:38:42.162302 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m13:38:42.162493 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m13:38:42.162675 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:38:42.162854 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:38:42.163030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:42.255142 [debug] [Thread-2 (]: SQL status: BEGIN in 0.092 seconds
[0m13:38:42.255543 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:38:42.255867 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m13:38:42.259096 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m13:38:42.259400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m13:38:42.259681 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:38:42.259969 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:38:42.260274 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m13:38:42.260582 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m13:38:42.294748 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.039 seconds
[0m13:38:42.297994 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:38:42.298413 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m13:38:42.307533 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m13:38:42.310315 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:38:42.310713 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.050 seconds
[0m13:38:42.311077 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m13:38:42.311510 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.051 seconds
[0m13:38:42.314539 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:38:42.317551 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:38:42.317914 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m13:38:42.318262 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m13:38:42.323529 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m13:38:42.328433 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m13:38:42.328784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m13:38:42.329067 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m13:38:42.329367 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:38:42.331847 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:38:42.334250 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:38:42.334593 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m13:38:42.334913 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m13:38:42.335237 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m13:38:42.343437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m13:38:42.343785 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m13:38:42.344998 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m13:38:42.346179 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m13:38:42.346502 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:38:42.346814 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:38:42.347116 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m13:38:42.347387 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m13:38:42.348146 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m13:38:42.349853 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m13:38:42.352230 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:38:42.352560 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m13:38:42.356838 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m13:38:42.357133 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m13:38:42.359920 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m13:38:42.361462 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m13:38:42.361960 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:38:42.362356 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:38:42.362646 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m13:38:42.362929 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m13:38:42.367137 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.014 seconds
[0m13:38:42.368247 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m13:38:42.368742 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721a6f0>]}
[0m13:38:42.369230 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.23s]
[0m13:38:42.369690 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m13:38:42.385347 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.022 seconds
[0m13:38:42.386555 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m13:38:42.386889 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.024 seconds
[0m13:38:42.388053 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m13:38:42.388432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105933560>]}
[0m13:38:42.389295 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '061ac5ae-4557-4e27-a600-9745fea751e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105931310>]}
[0m13:38:42.388954 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.25s]
[0m13:38:42.389881 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.25s]
[0m13:38:42.390327 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m13:38:42.390731 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m13:38:42.391704 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:42.391980 [debug] [MainThread]: On master: BEGIN
[0m13:38:42.392219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:42.504611 [debug] [MainThread]: SQL status: BEGIN in 0.112 seconds
[0m13:38:42.505206 [debug] [MainThread]: On master: COMMIT
[0m13:38:42.505593 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:42.505949 [debug] [MainThread]: On master: COMMIT
[0m13:38:42.524900 [debug] [MainThread]: SQL status: COMMIT in 0.019 seconds
[0m13:38:42.525390 [debug] [MainThread]: On master: Close
[0m13:38:42.526163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:42.526600 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m13:38:42.527008 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m13:38:42.527415 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_sales' was properly closed.
[0m13:38:42.527827 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m13:38:42.528408 [info ] [MainThread]: 
[0m13:38:42.528955 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m13:38:42.530674 [debug] [MainThread]: Command end result
[0m13:38:42.559549 [info ] [MainThread]: 
[0m13:38:42.560000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:42.560313 [info ] [MainThread]: 
[0m13:38:42.560631 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:38:42.567209 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6800122, "process_user_time": 1.432947, "process_kernel_time": 0.232138, "process_mem_max_rss": "127107072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:38:42.567855 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:42.567776 after 1.68 seconds
[0m13:38:42.568200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e09070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb54c0>]}
[0m13:38:42.568517 [debug] [MainThread]: Flushing usage events
[0m14:05:09.876326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087948f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e8260>]}


============================== 14:05:09.880351 | 74622cde-1f29-4912-b5c9-855feced874d ==============================
[0m14:05:09.880351 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:05:09.880751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tyler/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/tyler/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:09.923764 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:05:09.924106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087eb680>]}
[0m14:05:10.015885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc6e70>]}
[0m14:05:10.056649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b7b30>]}
[0m14:05:10.057465 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:05:10.068486 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:05:10.149259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:10.149551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:10.152713 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m14:05:10.174541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5e2d0>]}
[0m14:05:10.238079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e36c60>]}
[0m14:05:10.238506 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m14:05:10.238761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ffa7b0>]}
[0m14:05:10.240103 [info ] [MainThread]: 
[0m14:05:10.240569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:10.243006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m14:05:10.276561 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m14:05:10.276839 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m14:05:10.277014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:10.437008 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.160 seconds
[0m14:05:10.438880 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m14:05:10.440631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m14:05:10.441206 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m14:05:10.447673 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m14:05:10.449445 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m14:05:10.449804 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m14:05:10.450094 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m14:05:10.450368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:10.450629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:10.559191 [debug] [ThreadPool]: SQL status: BEGIN in 0.109 seconds
[0m14:05:10.559664 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m14:05:10.560020 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:05:10.567909 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m14:05:10.568292 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m14:05:10.568603 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m14:05:10.575195 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.015 seconds
[0m14:05:10.577217 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m14:05:10.583127 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m14:05:10.584404 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m14:05:10.587001 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m14:05:10.595893 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m14:05:10.602052 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:10.602466 [debug] [MainThread]: On master: BEGIN
[0m14:05:10.602765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:10.698655 [debug] [MainThread]: SQL status: BEGIN in 0.096 seconds
[0m14:05:10.699696 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:10.700660 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:10.718122 [debug] [MainThread]: SQL status: SELECT 3 in 0.016 seconds
[0m14:05:10.721209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aabe60>]}
[0m14:05:10.721840 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:10.730452 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:10.731224 [debug] [MainThread]: On master: BEGIN
[0m14:05:10.750399 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m14:05:10.751135 [debug] [MainThread]: On master: COMMIT
[0m14:05:10.751697 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:10.752160 [debug] [MainThread]: On master: COMMIT
[0m14:05:10.762626 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m14:05:10.764602 [debug] [MainThread]: On master: Close
[0m14:05:10.766159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:10.766754 [info ] [MainThread]: 
[0m14:05:10.771166 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m14:05:10.771787 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m14:05:10.772266 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m14:05:10.772817 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m14:05:10.773459 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m14:05:10.773935 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m14:05:10.774495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m14:05:10.775140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m14:05:10.775688 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m14:05:10.776332 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m14:05:10.776690 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m14:05:10.777046 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m14:05:10.783997 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m14:05:10.786241 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m14:05:10.788373 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m14:05:10.789137 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m14:05:10.789491 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m14:05:10.789809 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m14:05:10.830617 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m14:05:10.831453 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m14:05:10.834166 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m14:05:10.835471 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:05:10.836225 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m14:05:10.836587 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:05:10.836955 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:05:10.837330 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:05:10.837663 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m14:05:10.837945 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m14:05:10.838235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:10.838513 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:05:10.930298 [debug] [Thread-3 (]: SQL status: BEGIN in 0.092 seconds
[0m14:05:10.930804 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:05:10.931187 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m14:05:10.952124 [debug] [Thread-2 (]: SQL status: BEGIN in 0.115 seconds
[0m14:05:10.952548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.114 seconds
[0m14:05:10.952984 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:05:10.953309 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:05:10.953626 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m14:05:10.953947 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m14:05:10.954478 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m14:05:10.960067 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:05:10.960433 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m14:05:10.970748 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m14:05:10.974669 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:05:10.975097 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m14:05:10.993701 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m14:05:11.004716 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m14:05:11.009380 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m14:05:11.009767 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.055 seconds
[0m14:05:11.012430 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:05:11.012795 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:05:11.014826 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:05:11.015105 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:05:11.015347 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m14:05:11.015586 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:05:11.032035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m14:05:11.032431 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m14:05:11.034815 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:05:11.037006 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:05:11.037366 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:05:11.037651 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:05:11.048007 [debug] [Thread-3 (]: SQL status: COMMIT in 0.032 seconds
[0m14:05:11.048365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m14:05:11.053299 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m14:05:11.053596 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m14:05:11.054635 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m14:05:11.058164 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:05:11.059170 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m14:05:11.059448 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:05:11.059701 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m14:05:11.059939 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:05:11.060159 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m14:05:11.060438 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m14:05:11.074944 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.014 seconds
[0m14:05:11.075481 [debug] [Thread-2 (]: SQL status: COMMIT in 0.015 seconds
[0m14:05:11.075800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m14:05:11.077814 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m14:05:11.079441 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m14:05:11.080807 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m14:05:11.081242 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:05:11.082234 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac81af0>]}
[0m14:05:11.082586 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:05:11.082843 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m14:05:11.083260 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.31s]
[0m14:05:11.083547 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m14:05:11.083986 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m14:05:11.084448 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m14:05:11.084716 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m14:05:11.084986 [info ] [Thread-4 (]: 4 of 6 START sql table model public.orders_by_customer ......................... [RUN]
[0m14:05:11.085290 [info ] [Thread-3 (]: 5 of 6 START sql table model public.orders_by_day .............................. [RUN]
[0m14:05:11.085607 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m14:05:11.085943 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_day)
[0m14:05:11.086167 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m14:05:11.086380 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m14:05:11.088067 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m14:05:11.089744 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m14:05:11.090988 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m14:05:11.091236 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m14:05:11.106366 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m14:05:11.108516 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m14:05:11.108851 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.025 seconds
[0m14:05:11.109107 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.025 seconds
[0m14:05:11.110112 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m14:05:11.110351 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:05:11.110551 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:05:11.111245 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m14:05:11.111485 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m14:05:11.111751 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac68fe0>]}
[0m14:05:11.111955 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m14:05:11.112164 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:05:11.112377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad23350>]}
[0m14:05:11.112729 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.34s]
[0m14:05:11.112954 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:11.113336 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.34s]
[0m14:05:11.113669 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m14:05:11.114036 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m14:05:11.114286 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m14:05:11.114614 [info ] [Thread-2 (]: 6 of 6 START sql table model public.product_performance ........................ [RUN]
[0m14:05:11.114889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m14:05:11.115081 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m14:05:11.116524 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m14:05:11.116939 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m14:05:11.118629 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m14:05:11.118964 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:05:11.119147 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m14:05:11.119316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:05:11.223982 [debug] [Thread-3 (]: SQL status: BEGIN in 0.112 seconds
[0m14:05:11.224443 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:05:11.224768 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m14:05:11.227044 [debug] [Thread-2 (]: SQL status: BEGIN in 0.108 seconds
[0m14:05:11.227354 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:05:11.227672 [debug] [Thread-4 (]: SQL status: BEGIN in 0.115 seconds
[0m14:05:11.228033 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m14:05:11.228361 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:05:11.228712 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m14:05:11.271623 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.043 seconds
[0m14:05:11.272088 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.047 seconds
[0m14:05:11.275213 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:05:11.275661 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.047 seconds
[0m14:05:11.278610 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:05:11.279021 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m14:05:11.281392 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:05:11.281723 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m14:05:11.282125 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m14:05:11.291546 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m14:05:11.291897 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m14:05:11.294284 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:05:11.294642 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m14:05:11.297120 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:05:11.297523 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m14:05:11.300011 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:05:11.300368 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m14:05:11.300778 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m14:05:11.311525 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m14:05:11.311927 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m14:05:11.312230 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m14:05:11.316921 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m14:05:11.318220 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m14:05:11.319300 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m14:05:11.319600 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:05:11.319886 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:05:11.320155 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:05:11.320423 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m14:05:11.320686 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m14:05:11.320946 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m14:05:11.337628 [debug] [Thread-4 (]: SQL status: COMMIT in 0.016 seconds
[0m14:05:11.338001 [debug] [Thread-2 (]: SQL status: COMMIT in 0.017 seconds
[0m14:05:11.338285 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m14:05:11.340544 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m14:05:11.344352 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m14:05:11.346403 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m14:05:11.348857 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:05:11.349322 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:05:11.349796 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:05:11.350134 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m14:05:11.350526 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m14:05:11.350861 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m14:05:11.365124 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.014 seconds
[0m14:05:11.366438 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m14:05:11.367039 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af16570>]}
[0m14:05:11.367562 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.28s]
[0m14:05:11.368045 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m14:05:11.374805 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.024 seconds
[0m14:05:11.376206 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m14:05:11.376621 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.025 seconds
[0m14:05:11.377939 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m14:05:11.378333 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887fb00>]}
[0m14:05:11.378880 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.26s]
[0m14:05:11.379391 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m14:05:11.379730 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74622cde-1f29-4912-b5c9-855feced874d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ade6810>]}
[0m14:05:11.380280 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.29s]
[0m14:05:11.380746 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m14:05:11.381703 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:11.381971 [debug] [MainThread]: On master: BEGIN
[0m14:05:11.382204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:11.490903 [debug] [MainThread]: SQL status: BEGIN in 0.109 seconds
[0m14:05:11.491337 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.491604 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:11.491850 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.502884 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m14:05:11.503390 [debug] [MainThread]: On master: Close
[0m14:05:11.504012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:11.504308 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m14:05:11.504562 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m14:05:11.504806 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m14:05:11.505048 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m14:05:11.505464 [info ] [MainThread]: 
[0m14:05:11.505845 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m14:05:11.506920 [debug] [MainThread]: Command end result
[0m14:05:11.530916 [info ] [MainThread]: 
[0m14:05:11.531422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:11.531718 [info ] [MainThread]: 
[0m14:05:11.532016 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:05:11.534524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7034733, "process_user_time": 1.483467, "process_kernel_time": 0.217463, "process_mem_max_rss": "128712704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:11.535318 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:11.535186 after 1.70 seconds
[0m14:05:11.535752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b8ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108795c10>]}
[0m14:05:11.536104 [debug] [MainThread]: Flushing usage events
[0m14:30:01.201239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d89010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105043bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105070080>]}


============================== 14:30:01.205134 | 7839a4b9-136c-471d-96a9-fbdceb436ba1 ==============================
[0m14:30:01.205134 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:30:01.205592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/tyler/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:30:01.249469 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:30:01.249795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513b2f0>]}
[0m14:30:01.338020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d89d30>]}
[0m14:30:01.378062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463ae10>]}
[0m14:30:01.378873 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:30:01.390566 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:30:01.471271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:01.471563 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:01.474701 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m14:30:01.498285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054699a0>]}
[0m14:30:01.559931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105587530>]}
[0m14:30:01.560288 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m14:30:01.560567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572e840>]}
[0m14:30:01.561878 [info ] [MainThread]: 
[0m14:30:01.562243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:01.564484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m14:30:01.598902 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m14:30:01.599212 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m14:30:01.599405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:01.734210 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.135 seconds
[0m14:30:01.735979 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m14:30:01.737711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m14:30:01.738280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m14:30:01.744137 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m14:30:01.746058 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m14:30:01.746504 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m14:30:01.746902 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m14:30:01.747253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:01.747559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:01.857282 [debug] [ThreadPool]: SQL status: BEGIN in 0.110 seconds
[0m14:30:01.857853 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m14:30:01.858242 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m14:30:01.862088 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m14:30:01.862536 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m14:30:01.862870 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:30:01.872683 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m14:30:01.874018 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m14:30:01.877209 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.014 seconds
[0m14:30:01.878411 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m14:30:01.885161 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m14:30:01.890084 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m14:30:01.897442 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:01.897844 [debug] [MainThread]: On master: BEGIN
[0m14:30:01.898122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:02.024053 [debug] [MainThread]: SQL status: BEGIN in 0.126 seconds
[0m14:30:02.024853 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:02.025536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:30:02.048480 [debug] [MainThread]: SQL status: SELECT 3 in 0.022 seconds
[0m14:30:02.052295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105991f40>]}
[0m14:30:02.053067 [debug] [MainThread]: On master: ROLLBACK
[0m14:30:02.067996 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:02.068755 [debug] [MainThread]: On master: BEGIN
[0m14:30:02.095939 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m14:30:02.096768 [debug] [MainThread]: On master: COMMIT
[0m14:30:02.097386 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:02.097844 [debug] [MainThread]: On master: COMMIT
[0m14:30:02.111937 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m14:30:02.112721 [debug] [MainThread]: On master: Close
[0m14:30:02.113699 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:30:02.114324 [info ] [MainThread]: 
[0m14:30:02.118475 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m14:30:02.118916 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m14:30:02.119243 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m14:30:02.119747 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m14:30:02.120225 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m14:30:02.120702 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m14:30:02.121137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m14:30:02.121473 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m14:30:02.121841 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m14:30:02.122157 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m14:30:02.122471 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m14:30:02.122783 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m14:30:02.129503 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m14:30:02.131447 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m14:30:02.133167 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m14:30:02.133985 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m14:30:02.140590 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m14:30:02.140907 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m14:30:02.161180 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m14:30:02.163701 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m14:30:02.166260 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m14:30:02.166976 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:30:02.167274 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m14:30:02.167564 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:30:02.167996 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:30:02.168282 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:30:02.168505 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m14:30:02.168750 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m14:30:02.168973 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:30:02.169192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:02.282519 [debug] [Thread-3 (]: SQL status: BEGIN in 0.113 seconds
[0m14:30:02.282898 [debug] [Thread-2 (]: SQL status: BEGIN in 0.115 seconds
[0m14:30:02.283254 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:30:02.283536 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:30:02.283822 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m14:30:02.284115 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m14:30:02.286455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.117 seconds
[0m14:30:02.286724 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:30:02.286994 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m14:30:02.319719 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.035 seconds
[0m14:30:02.327618 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:30:02.328036 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.044 seconds
[0m14:30:02.328386 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m14:30:02.328715 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:30:02.332395 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:30:02.334581 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:30:02.334948 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m14:30:02.335250 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:30:02.346377 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m14:30:02.346721 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m14:30:02.348547 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:30:02.348777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m14:30:02.350554 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:30:02.350819 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m14:30:02.352705 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:30:02.352985 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:30:02.353313 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:30:02.362386 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m14:30:02.372328 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m14:30:02.375313 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m14:30:02.375584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m14:30:02.376578 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m14:30:02.376850 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:30:02.377677 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m14:30:02.377923 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:30:02.378246 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m14:30:02.378488 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:30:02.378714 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m14:30:02.379005 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m14:30:02.394629 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m14:30:02.395022 [debug] [Thread-2 (]: SQL status: COMMIT in 0.016 seconds
[0m14:30:02.399691 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m14:30:02.400023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m14:30:02.401622 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m14:30:02.405023 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m14:30:02.406488 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m14:30:02.406896 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m14:30:02.407165 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m14:30:02.407504 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m14:30:02.407744 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m14:30:02.408051 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m14:30:02.421863 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.014 seconds
[0m14:30:02.422159 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.014 seconds
[0m14:30:02.424149 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m14:30:02.424457 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m14:30:02.425552 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m14:30:02.426794 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m14:30:02.427948 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103983290>]}
[0m14:30:02.428498 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.31s]
[0m14:30:02.428998 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m14:30:02.429360 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7bc50>]}
[0m14:30:02.429668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105770740>]}
[0m14:30:02.430378 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.31s]
[0m14:30:02.431020 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m14:30:02.431321 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m14:30:02.431678 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m14:30:02.432037 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m14:30:02.432332 [info ] [Thread-4 (]: 4 of 6 START sql table model public.orders_by_customer ......................... [RUN]
[0m14:30:02.432676 [info ] [Thread-3 (]: 5 of 6 START sql table model public.orders_by_day .............................. [RUN]
[0m14:30:02.433059 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m14:30:02.433335 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m14:30:02.433768 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m14:30:02.434073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_day)
[0m14:30:02.434478 [info ] [Thread-2 (]: 6 of 6 START sql table model public.product_performance ........................ [RUN]
[0m14:30:02.434775 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m14:30:02.435023 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m14:30:02.435288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m14:30:02.437278 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m14:30:02.438941 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m14:30:02.439205 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m14:30:02.441005 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m14:30:02.441473 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m14:30:02.441916 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m14:30:02.448323 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m14:30:02.460612 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m14:30:02.462910 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m14:30:02.464815 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m14:30:02.465541 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:30:02.465873 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:30:02.466127 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m14:30:02.466355 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:30:02.466578 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m14:30:02.466835 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:30:02.467063 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m14:30:02.467269 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:30:02.467618 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:30:02.572667 [debug] [Thread-4 (]: SQL status: BEGIN in 0.105 seconds
[0m14:30:02.573040 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:30:02.573300 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m14:30:02.577466 [debug] [Thread-3 (]: SQL status: BEGIN in 0.111 seconds
[0m14:30:02.577727 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:30:02.577972 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m14:30:02.581449 [debug] [Thread-2 (]: SQL status: BEGIN in 0.114 seconds
[0m14:30:02.581684 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:30:02.581921 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m14:30:02.622860 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.045 seconds
[0m14:30:02.625238 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:30:02.625607 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.043 seconds
[0m14:30:02.626029 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.052 seconds
[0m14:30:02.626483 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m14:30:02.629015 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:30:02.631139 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:30:02.631573 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m14:30:02.631874 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m14:30:02.641178 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m14:30:02.643241 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:30:02.643520 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m14:30:02.643782 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m14:30:02.644051 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m14:30:02.645924 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:30:02.647727 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:30:02.648049 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m14:30:02.648329 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m14:30:02.658998 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m14:30:02.659347 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m14:30:02.659605 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m14:30:02.663365 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m14:30:02.664423 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m14:30:02.665319 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m14:30:02.665593 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:30:02.665837 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:30:02.666192 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:30:02.666428 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m14:30:02.666665 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m14:30:02.666888 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m14:30:02.679305 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m14:30:02.680789 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m14:30:02.683005 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m14:30:02.683355 [debug] [Thread-2 (]: SQL status: COMMIT in 0.016 seconds
[0m14:30:02.683832 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m14:30:02.684286 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m14:30:02.687235 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m14:30:02.688682 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m14:30:02.689132 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m14:30:02.689549 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m14:30:02.689844 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m14:30:02.690140 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m14:30:02.701147 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m14:30:02.702246 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m14:30:02.702684 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be9b20>]}
[0m14:30:02.703074 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.27s]
[0m14:30:02.703441 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m14:30:02.710222 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.020 seconds
[0m14:30:02.711207 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m14:30:02.711476 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.021 seconds
[0m14:30:02.712380 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m14:30:02.712704 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575bb30>]}
[0m14:30:02.713134 [info ] [Thread-3 (]: 5 of 6 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.28s]
[0m14:30:02.713456 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7839a4b9-136c-471d-96a9-fbdceb436ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575b500>]}
[0m14:30:02.713801 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m14:30:02.714183 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.28s]
[0m14:30:02.714617 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m14:30:02.715395 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:02.715617 [debug] [MainThread]: On master: BEGIN
[0m14:30:02.715809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:02.826563 [debug] [MainThread]: SQL status: BEGIN in 0.110 seconds
[0m14:30:02.828200 [debug] [MainThread]: On master: COMMIT
[0m14:30:02.828635 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:02.828856 [debug] [MainThread]: On master: COMMIT
[0m14:30:02.840778 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m14:30:02.841113 [debug] [MainThread]: On master: Close
[0m14:30:02.841490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:02.841684 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m14:30:02.841858 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m14:30:02.842022 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m14:30:02.842181 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m14:30:02.842439 [info ] [MainThread]: 
[0m14:30:02.842658 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m14:30:02.843421 [debug] [MainThread]: Command end result
[0m14:30:02.862244 [info ] [MainThread]: 
[0m14:30:02.862667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:02.862901 [info ] [MainThread]: 
[0m14:30:02.863197 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:30:02.865126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7117331, "process_user_time": 1.457111, "process_kernel_time": 0.212207, "process_mem_max_rss": "129089536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:30:02.865626 [debug] [MainThread]: Command `dbt run` succeeded at 14:30:02.865562 after 1.71 seconds
[0m14:30:02.865896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d99340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046fa570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105043bc0>]}
[0m14:30:02.866139 [debug] [MainThread]: Flushing usage events
[0m10:18:49.285003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11100b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111628860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111628260>]}


============================== 10:18:49.288272 | baac4d0d-7755-47dd-902d-c688ba479255 ==============================
[0m10:18:49.288272 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:18:49.288656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/dbt_visualization', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tyler/dbt_visualization/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:18:49.326089 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:18:49.326372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ae120>]}
[0m10:18:49.402112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c5160>]}
[0m10:18:49.438697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116e79e0>]}
[0m10:18:49.439421 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:18:49.448921 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:18:49.520464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:18:49.520743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:18:49.523681 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m10:18:49.543449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bf70e0>]}
[0m10:18:49.599419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dd2ed0>]}
[0m10:18:49.599733 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m10:18:49.599924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bf7500>]}
[0m10:18:49.600974 [info ] [MainThread]: 
[0m10:18:49.601300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:18:49.603441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m10:18:49.646400 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m10:18:49.646655 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m10:18:49.646830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:49.855083 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.208 seconds
[0m10:18:49.858255 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m10:18:49.860894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m10:18:49.861658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m10:18:49.870498 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m10:18:49.872685 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m10:18:49.873154 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m10:18:49.873539 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m10:18:49.873900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:49.874250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:49.998331 [debug] [ThreadPool]: SQL status: BEGIN in 0.124 seconds
[0m10:18:49.999658 [debug] [ThreadPool]: SQL status: BEGIN in 0.125 seconds
[0m10:18:50.000867 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m10:18:50.002104 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m10:18:50.003592 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:18:50.004770 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m10:18:50.022307 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m10:18:50.023680 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.018 seconds
[0m10:18:50.028883 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m10:18:50.032762 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m10:18:50.042492 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m10:18:50.045739 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m10:18:50.068487 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:50.069207 [debug] [MainThread]: On master: BEGIN
[0m10:18:50.069688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:50.173463 [debug] [MainThread]: SQL status: BEGIN in 0.103 seconds
[0m10:18:50.175162 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:50.176536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:18:50.199084 [debug] [MainThread]: SQL status: SELECT 4 in 0.021 seconds
[0m10:18:50.203572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11293f290>]}
[0m10:18:50.204455 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:50.213094 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:50.214003 [debug] [MainThread]: On master: BEGIN
[0m10:18:50.233148 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m10:18:50.234606 [debug] [MainThread]: On master: COMMIT
[0m10:18:50.235569 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:50.236545 [debug] [MainThread]: On master: COMMIT
[0m10:18:50.244994 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m10:18:50.246125 [debug] [MainThread]: On master: Close
[0m10:18:50.247897 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:18:50.248995 [info ] [MainThread]: 
[0m10:18:50.255712 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m10:18:50.256612 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m10:18:50.257417 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m10:18:50.258390 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m10:18:50.259396 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m10:18:50.260238 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m10:18:50.261076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m10:18:50.261735 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m10:18:50.262513 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m10:18:50.263156 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m10:18:50.263755 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m10:18:50.264343 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m10:18:50.277620 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m10:18:50.281599 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m10:18:50.284761 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m10:18:50.285865 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m10:18:50.286382 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m10:18:50.286919 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m10:18:50.322856 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m10:18:50.325193 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m10:18:50.327158 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m10:18:50.327682 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m10:18:50.327950 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m10:18:50.328185 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m10:18:50.328449 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m10:18:50.328719 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m10:18:50.328956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:50.329190 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:18:50.329411 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m10:18:50.329840 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:18:50.441895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.113 seconds
[0m10:18:50.442436 [debug] [Thread-3 (]: SQL status: BEGIN in 0.113 seconds
[0m10:18:50.442931 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m10:18:50.443396 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m10:18:50.443883 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m10:18:50.444397 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m10:18:50.447328 [debug] [Thread-2 (]: SQL status: BEGIN in 0.118 seconds
[0m10:18:50.447853 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m10:18:50.448336 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m10:18:50.469400 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m10:18:50.479154 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m10:18:50.479648 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m10:18:50.480096 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.035 seconds
[0m10:18:50.480531 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m10:18:50.485320 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m10:18:50.488466 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m10:18:50.488931 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m10:18:50.489327 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m10:18:50.498579 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:18:50.501314 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m10:18:50.501734 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m10:18:50.502204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:18:50.502828 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:18:50.505916 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m10:18:50.508779 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m10:18:50.509234 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m10:18:50.509696 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m10:18:50.514619 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:18:50.528277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m10:18:50.533125 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m10:18:50.533493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m10:18:50.534724 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m10:18:50.535055 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m10:18:50.536085 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m10:18:50.536390 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m10:18:50.536679 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m10:18:50.536962 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m10:18:50.537239 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m10:18:50.537584 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m10:18:50.555751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m10:18:50.556112 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m10:18:50.561639 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m10:18:50.561958 [debug] [Thread-2 (]: SQL status: COMMIT in 0.024 seconds
[0m10:18:50.563671 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m10:18:50.567496 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m10:18:50.569032 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m10:18:50.569427 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m10:18:50.569706 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m10:18:50.570070 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m10:18:50.570336 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m10:18:50.570658 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m10:18:50.587110 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m10:18:50.587403 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.016 seconds
[0m10:18:50.589312 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m10:18:50.589641 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.019 seconds
[0m10:18:50.590658 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m10:18:50.591707 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m10:18:50.592762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723b050>]}
[0m10:18:50.593172 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a7b9b0>]}
[0m10:18:50.593598 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.33s]
[0m10:18:50.593919 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dd3740>]}
[0m10:18:50.594308 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.33s]
[0m10:18:50.594726 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m10:18:50.595099 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.33s]
[0m10:18:50.595485 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m10:18:50.595936 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m10:18:50.596509 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m10:18:50.596816 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m10:18:50.597118 [info ] [Thread-4 (]: 4 of 6 START sql table model public.orders_by_customer ......................... [RUN]
[0m10:18:50.597411 [debug] [Thread-3 (]: Began running node model.ecommerce_project.product_performance
[0m10:18:50.597752 [info ] [Thread-1 (]: 5 of 6 START sql table model public.orders_by_day .............................. [RUN]
[0m10:18:50.598116 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m10:18:50.598441 [info ] [Thread-3 (]: 6 of 6 START sql table model public.product_performance ........................ [RUN]
[0m10:18:50.598735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_day)
[0m10:18:50.598998 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m10:18:50.599246 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.product_performance)
[0m10:18:50.599480 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m10:18:50.601259 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m10:18:50.601528 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.product_performance
[0m10:18:50.603129 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m10:18:50.604681 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m10:18:50.605068 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m10:18:50.605324 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m10:18:50.617859 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.product_performance
[0m10:18:50.619977 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m10:18:50.621627 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m10:18:50.623203 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m10:18:50.623642 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m10:18:50.623916 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m10:18:50.624113 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m10:18:50.624306 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m10:18:50.624487 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: BEGIN
[0m10:18:50.624668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:50.624847 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m10:18:50.625017 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:18:50.625256 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:18:50.733805 [debug] [Thread-4 (]: SQL status: BEGIN in 0.108 seconds
[0m10:18:50.734285 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m10:18:50.734654 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m10:18:50.738311 [debug] [Thread-3 (]: SQL status: BEGIN in 0.113 seconds
[0m10:18:50.738690 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m10:18:50.739107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.114 seconds
[0m10:18:50.739481 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m10:18:50.739854 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m10:18:50.740253 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m10:18:50.787810 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.048 seconds
[0m10:18:50.791386 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m10:18:50.791844 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.057 seconds
[0m10:18:50.792302 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.052 seconds
[0m10:18:50.792670 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m10:18:50.795980 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m10:18:50.798974 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m10:18:50.799410 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m10:18:50.799764 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m10:18:50.810236 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:18:50.813187 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m10:18:50.813611 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m10:18:50.813989 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m10:18:50.814369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m10:18:50.817195 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m10:18:50.820177 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m10:18:50.820578 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m10:18:50.820929 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m10:18:50.826206 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:18:50.831058 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m10:18:50.831423 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:18:50.831715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:18:50.832023 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m10:18:50.833266 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m10:18:50.834608 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m10:18:50.834960 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m10:18:50.835281 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m10:18:50.835599 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m10:18:50.835975 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m10:18:50.836306 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m10:18:50.853191 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m10:18:50.853528 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m10:18:50.855296 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m10:18:50.855607 [debug] [Thread-4 (]: SQL status: COMMIT in 0.020 seconds
[0m10:18:50.858814 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m10:18:50.861340 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m10:18:50.863248 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m10:18:50.863734 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m10:18:50.864050 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m10:18:50.864454 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m10:18:50.864750 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m10:18:50.865082 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m10:18:50.883356 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.018 seconds
[0m10:18:50.884611 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m10:18:50.884968 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.020 seconds
[0m10:18:50.885388 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111445c70>]}
[0m10:18:50.886567 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: Close
[0m10:18:50.886904 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.022 seconds
[0m10:18:50.887457 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.29s]
[0m10:18:50.888674 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m10:18:50.889080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b19610>]}
[0m10:18:50.889593 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m10:18:50.890096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac4d0d-7755-47dd-902d-c688ba479255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a7b1d0>]}
[0m10:18:50.890563 [info ] [Thread-3 (]: 6 of 6 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.29s]
[0m10:18:50.891158 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.29s]
[0m10:18:50.891607 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.product_performance
[0m10:18:50.892020 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m10:18:50.892982 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:50.893246 [debug] [MainThread]: On master: BEGIN
[0m10:18:50.893478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:51.015033 [debug] [MainThread]: SQL status: BEGIN in 0.121 seconds
[0m10:18:51.016144 [debug] [MainThread]: On master: COMMIT
[0m10:18:51.016732 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:51.017315 [debug] [MainThread]: On master: COMMIT
[0m10:18:51.030884 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m10:18:51.031809 [debug] [MainThread]: On master: Close
[0m10:18:51.033156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:51.033867 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m10:18:51.034518 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_products' was properly closed.
[0m10:18:51.035148 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m10:18:51.035778 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m10:18:51.036864 [info ] [MainThread]: 
[0m10:18:51.037823 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m10:18:51.041347 [debug] [MainThread]: Command end result
[0m10:18:51.081400 [info ] [MainThread]: 
[0m10:18:51.081903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:51.082217 [info ] [MainThread]: 
[0m10:18:51.082562 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:18:51.093205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8514595, "process_user_time": 1.546056, "process_kernel_time": 0.210901, "process_mem_max_rss": "127582208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:18:51.093788 [debug] [MainThread]: Command `dbt run` succeeded at 10:18:51.093705 after 1.85 seconds
[0m10:18:51.094171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c62fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11147d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129df800>]}
[0m10:18:51.094513 [debug] [MainThread]: Flushing usage events
